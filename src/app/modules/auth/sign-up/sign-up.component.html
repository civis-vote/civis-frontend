<div class="sign-up-index row no-gutters">
  <div class="sign-up-index__left col-md-4">
    <div class="overlay"></div>
    <div class="cover-detail">
      <button class="back-btn" [routerLink]="['/']">
        <span><i class="fa fa-angle-left back-arrow"></i></span>
        {{ "Back" | translate }}
      </button>
      <app-case-studies-list></app-case-studies-list>
    </div>
  </div>

  <div class="sign-up-index__right col-md-8 col-12">
    <div class="header">
      <div class="logo-container">
        <img
          class="logo"
          [routerLink]="['/']"
          src="assets/images/brand-logo/brand-logo.svg"
        />
      </div>
      <div class="login-container">
        <p class="auth-text">
          {{ "Already have an account with Civis?" | translate }}
        </p>
        <button
          class="app-btn circular auth-btn"
          [routerLink]="['/auth', 'login']"
        >
          {{ "Sign In" | translate }}
        </button>
      </div>
      <div class="login-mobile-container">
        <div>
          <button
            class="app-btn primary sign-in-btn"
            [routerLink]="['/auth', 'login']"
          >
            {{ "Sign In" | translate }}
          </button>
        </div>
      </div>
    </div>
    <p class="logo-heading">
      {{ "Sign up as a Citizen Leader." | translate }}<br />
      {{ "Join the movement towards citizen-led governance." | translate }}
    </p>

    <div class="form-space no-gutters mt-md-5 mt-2">
      <div class="row">
        <div class="form-space-right col-md-5">
          <button class="app-btn gmail mb-3" (click)="redirectTo('google')">
            <div class="social-img">
              <picture>
                <source srcset="assets/images/Gmail.webp" type="image/webp" />
                <source srcset="assets/images/Gmail.jpg" type="image/jpeg" />
                <img src="assets/images/Gmail.jpg" alt="Gmail logo" />
              </picture>
            </div>
            <p class="mb-0 ml-4">{{ "Sign up with Google" | translate }}</p>
          </button>
          <button class="app-btn facebook" (click)="redirectTo('facebook')">
            <div class="social-img">
              <picture>
                <source
                  srcset="assets/images/Facebook.webp"
                  type="image/webp"
                />
                <source srcset="assets/images/Facebook.jpg" type="image/jpeg" />
                <img src="assets/images/Facebook.jpg" alt="Facebook logo" />
              </picture>
            </div>
            <p class="mb-0 ml-4">{{ "Sign up with Facebook" | translate }}</p>
          </button>
        </div>
      </div>

      <div class="row">
        <div class="form-space-middle col-md-5">
          <div class="or-text">{{ "OR" | translate }}</div>
          <!-- horizontal-divider for mobile -->
          <hr class="horizontal-divider" data-content="OR" />
        </div>
      </div>

      <div class="row">
        <div class="form-space__left col-md-5">
          <form #emailSignupForm="ngForm" *ngIf="emailStep" autocomplete="off" (ngSubmit)="submitEmailSignup(emailSignupForm)">
            <div class="input-box required-field">
              <label for="email">{{ "Email" | translate }}</label>
              <div class="input-box__border">
                <input
                  [placeholder]="'Email' | translate"
                  type="email"
                  id="email"
                  name="email"
                  [(ngModel)]="emailForOtp"
                  required
                  email
                />
              </div>
              <div *ngIf="emailSignupForm.submitted && emailSignupForm.controls.email?.invalid" class="error-msg">
                <div *ngIf="emailSignupForm.controls.email?.errors?.required">
                  {{ "Email is Required" | translate }}
                </div>
                <div *ngIf="emailSignupForm.controls.email?.errors?.email">
                  {{ "Email must be a valid email address" | translate }}
                </div>
              </div>
              <div *ngIf="emailError" class="alert alert-danger mt-2">{{ emailError }}</div>
            </div>
            <div>
              <button class="app-btn secondary get-start-btn" type="submit" [disabled]="loadingEmail">
                <span *ngIf="!loadingEmail">{{'Continue' | translate}}</span>
                <span *ngIf="loadingEmail"><span class="spinner-border spinner-border-sm"></span> {{'Please wait...' | translate}}</span>
              </button>
            </div>
          </form>

          <form #otpForm="ngForm" *ngIf="otpStep" autocomplete="off" (ngSubmit)="submitOtp(otpForm)">
            <div class="input-box required-field">
              <label for="otp">OTP</label>
              <div class="input-box__border">
                <input
                  [placeholder]="'Enter OTP' | translate"
                  type="text"
                  id="otp"
                  name="otp"
                  [(ngModel)]="otp"
                  required
                  minlength="4"
                  maxlength="8"
                />
              </div>
              <div *ngIf="otpForm.submitted && otpForm.controls.otp?.invalid" class="error-msg">
                <div *ngIf="otpForm.controls.otp?.errors?.required">
                  {{ "OTP is Required" | translate }}
                </div>
              </div>
              <div *ngIf="otpError" class="alert alert-danger mt-2">{{ otpError }}</div>
            </div>
            <div class="mb-3">
              <a href="javascript:void(0)" (click)="resendOtp()" [class.disabled]="loadingOtp">
                {{ loadingOtp ? ('Resending...' | translate) : ('Resend OTP' | translate) }}
              </a>
            </div>
            <div>
              <button class="app-btn secondary get-start-btn" type="submit" [disabled]="loadingOtp">
                <span *ngIf="!loadingOtp">{{'Login' | translate}}</span>
                <span *ngIf="loadingOtp"><span class="spinner-border spinner-border-sm"></span> {{'Please wait...' | translate}}</span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="user-details-modal-overlay"
  *ngIf="showUserDetailsModal"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <form #userDetailsNgForm="ngForm" (ngSubmit)="submitUserDetails(userDetailsNgForm)" autocomplete="off">
        <div class="modal-header">
          <h5 class="modal-title">Complete Your Profile</h5>
        </div>
        <div class="modal-body">
          <div class="input-box required-field">
            <label for="userDetailsFirstName">First Name</label>
            <div class="input-box__border">
              <input
                type="text"
                id="userDetailsFirstName"
                name="firstName"
                [(ngModel)]="userDetailsForm.firstName"
                required
                [disabled]="userDetailsLoading"
              />
            </div>
            <div *ngIf="userDetailsNgForm.submitted && userDetailsNgForm.controls.firstName?.invalid" class="error-msg">
              First name is required.
            </div>
          </div>
          <div class="input-box required-field">
            <label for="userDetailsEmail">Email</label>
            <div class="input-box__border">
              <input
                type="email"
                id="userDetailsEmail"
                name="email"
                [(ngModel)]="userDetailsForm.email"
                required
                [readonly]="true"
              />
            </div>
          </div>
          <div class="location-box required-field">
            <label for="userDetailsCity">City</label>
            <div class="location-box__border">
              <ng-select
                id="userDetailsCity"
                name="cityId"
                [loading]="userDetailsCitiesLoading"
                [items]="userDetailsCities"
                bindLabel="name"
                bindValue="id"
                [virtualScroll]="true"
                dropdownPosition="bottom"
                [notFoundText]="'No cities found'"
                [clearable]="true"
                loadingText="Searching..."
                [(ngModel)]="userDetailsForm.cityId"
                required
              >
              </ng-select>
            </div>
            <div *ngIf="userDetailsNgForm.submitted && userDetailsNgForm.controls.cityId?.invalid" class="error-msg">
              City is required.
            </div>
          </div>
          <div *ngIf="userDetailsError" class="alert alert-danger mt-2">{{ userDetailsError }}</div>
        </div>
        <div class="modal-footer">
          <button class="app-btn secondary get-start-btn" type="submit" [disabled]="userDetailsLoading">
            <span *ngIf="!userDetailsLoading">Save</span>
            <span *ngIf="userDetailsLoading"><span class="spinner-border spinner-border-sm"></span> Please wait...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
